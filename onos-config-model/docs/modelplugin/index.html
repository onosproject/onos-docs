<!--
Copyright 2019-present Open Networking Foundation
SPDX-FileCopyrightText: 2022 2020-present Open Networking Foundation <info@opennetworking.org>

SPDX-License-Identifier: Apache-2.0
--> <!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Open Network Operating System (ONOS)"><meta name=author content="Open Networking Foundation"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.0.2"><title>Configuration Model Plugins - onosproject</title><link rel=stylesheet href=../../../assets/stylesheets/application.982221ab.css><script src=../../../assets/javascripts/modernizr.1f0bcf2b.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css><link rel=stylesheet href=../../../styles/css/extra.css><link rel=stylesheet href=../../../theme/css/onos-menu.css></head> <body dir=ltr> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github> <path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z"/> </svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#extending-onos-config-with-model-plugins tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=../../.. title=onosproject class="md-header-nav__button md-logo"> <img src=../../../images/onos_logo_2017.png width=24 height=24> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> onosproject </span> <span class=md-header-nav__topic> Configuration Model Plugins </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/onosproject title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> onosproject </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=../../.. title=onosproject class="md-nav__button md-logo"> <img src=../../../images/onos_logo_2017.png width=48 height=48> </a> onosproject </label> <div class=md-nav__source> <a href=https://github.com/onosproject title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> onosproject </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. title=ONOS class=md-nav__link> ONOS </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Developers </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Developers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/community-info/ title="Contacts and Calendars" class=md-nav__link> Contacts and Calendars </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/prerequisites/ title="Development Prerequisites" class=md-nav__link> Development Prerequisites </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/dev_workflow/ title="Developer Workflow" class=md-nav__link> Developer Workflow </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/contributing/ title="Contribution Guidelines" class=md-nav__link> Contribution Guidelines </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/godocs/ title="GoDoc Pages" class=md-nav__link> GoDoc Pages </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/deploy_with_helm/ title="Deploy with Helm" class=md-nav__link> Deploy with Helm </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/deploy_onos_classic/ title="Deploy ONOS classic" class=md-nav__link> Deploy ONOS classic </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/deploy_on_gcp/ title="Deploy with Helm on GCP" class=md-nav__link> Deploy with Helm on GCP </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Configuration Subsystem </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Configuration Subsystem </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-config/docs/ title="An Introduction to Configuration Susbsytem" class=md-nav__link> An Introduction to Configuration Susbsytem </a> </li> <li class=md-nav__item> <a href=../../../onos-config/docs/build/ title="How To Build Configuration Subsystem?" class=md-nav__link> How To Build Configuration Subsystem? </a> </li> <li class=md-nav__item> <a href=../../../onos-config/docs/run/ title="How To Run Configuration Subsystem?" class=md-nav__link> How To Run Configuration Subsystem? </a> </li> <li class=md-nav__item> <a href=../../../onos-config/docs/deployment/ title="How To Deploy with Helm" class=md-nav__link> How To Deploy with Helm </a> </li> <li class=md-nav__item> <a href=../../../onos-config/docs/cli/ title="Administrative CLI" class=md-nav__link> Administrative CLI </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Configuration Model Plugins </label> <a href=./ title="Configuration Model Plugins" class="md-nav__link md-nav__link--active"> Configuration Model Plugins </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#role-of-the-model-plugin title="Role of the Model Plugin" class=md-nav__link> Role of the Model Plugin </a> </li> <li class=md-nav__item> <a href=#onos-operator-deploy-time-compilation-of-model-plugins title="onos-operator deploy-time compilation of Model Plugins" class=md-nav__link> onos-operator deploy-time compilation of Model Plugins </a> </li> <li class=md-nav__item> <a href=#structure-of-a-model-plugin title="Structure of a Model Plugin" class=md-nav__link> Structure of a Model Plugin </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#modelplugin-interface title="ModelPlugin Interface" class=md-nav__link> ModelPlugin Interface </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-your-own-model-plugin title="Creating your own Model Plugin" class=md-nav__link> Creating your own Model Plugin </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#yang-files title="YANG files" class=md-nav__link> YANG files </a> </li> <li class=md-nav__item> <a href=#creating-templatesmodelyaml title="Creating templates/model.yaml" class=md-nav__link> Creating templates/model.yaml </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#verifying-compilation-and-installation-of-model-plugin title="Verifying compilation and installation of Model Plugin" class=md-nav__link> Verifying compilation and installation of Model Plugin </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#capabilities-on-gnmi-northbound-interface title="Capabilities on gNMI Northbound interface" class=md-nav__link> Capabilities on gNMI Northbound interface </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#openconfig-models title="OpenConfig Models" class=md-nav__link> OpenConfig Models </a> </li> <li class=md-nav__item> <a href=#readonly-paths-in-yang-models title="Readonly paths in YANG models" class=md-nav__link> Readonly paths in YANG models </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../onos-config/docs/gnmi/ title="Northbound gNMI Service" class=md-nav__link> Northbound gNMI Service </a> </li> <li class=md-nav__item> <a href=../../../onos-config/docs/gnmi_extensions/ title="gNMI Extensions" class=md-nav__link> gNMI Extensions </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-9 type=checkbox id=nav-3-9> <label class=md-nav__link for=nav-3-9> APIs </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-9> APIs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/admin/ title="Admin API" class=md-nav__link> Admin API </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-9-2 type=checkbox id=nav-3-9-2> <label class=md-nav__link for=nav-3-9-2> Types </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-3-9-2> Types </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/value/ title="Value Types" class=md-nav__link> Value Types </a> </li> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/configuration/ title="Configuration Types" class=md-nav__link> Configuration Types </a> </li> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/transaction/ title="Transaction Types" class=md-nav__link> Transaction Types </a> </li> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/proposal/ title="Proposal Types" class=md-nav__link> Proposal Types </a> </li> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/extensions/ title="Extension Types" class=md-nav__link> Extension Types </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Topology Subsystem </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Topology Subsystem </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-topo/docs/cli/ title="How To Use Topology Subsystem CLI?" class=md-nav__link> How To Use Topology Subsystem CLI? </a> </li> <li class=md-nav__item> <a href=../../../onos-topo/docs/deployment/ title="How To Deploy with Helm" class=md-nav__link> How To Deploy with Helm </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class=md-nav__link for=nav-4-3> APIs </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-3> APIs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/topo/topo/ title="Entity, Kind, Relationship API" class=md-nav__link> Entity, Kind, Relationship API </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Command Line Interface Subsystem (CLI) </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Command Line Interface Subsystem (CLI) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-cli/docs/setup/ title="How To Install and Run CLI Subsystem?" class=md-nav__link> How To Install and Run CLI Subsystem? </a> </li> <li class=md-nav__item> <a href=../../../onos-cli/docs/deployment/ title="How To Deploy with Helm" class=md-nav__link> How To Deploy with Helm </a> </li> <li class=md-nav__item> <a href=../../../onos-cli/docs/cli/onos/ title="ONOS CLI Commands" class=md-nav__link> ONOS CLI Commands </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Graphical User Interface (GUI) </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Graphical User Interface (GUI) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-gui/docs/ title="ONOS-GUI Subsystem" class=md-nav__link> ONOS-GUI Subsystem </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/config-gui/ title="Configuration GUI" class=md-nav__link> Configuration GUI </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/ran-gui/ title="SD-RAN GUI" class=md-nav__link> SD-RAN GUI </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/architecture/ title="GUI Architecture" class=md-nav__link> GUI Architecture </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/prerequisites/ title="GUI Development Prerequisites" class=md-nav__link> GUI Development Prerequisites </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/deployment/ title="How to Deploy and Run with Helm?" class=md-nav__link> How to Deploy and Run with Helm? </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Test Tools </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Test Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../helmit/docs/cli/ title="Getting Started with Helmit" class=md-nav__link> Getting Started with Helmit </a> </li> <li class=md-nav__item> <a href=../../../helmit/docs/api/ title="Kubernetes and Helm APIs" class=md-nav__link> Kubernetes and Helm APIs </a> </li> <li class=md-nav__item> <a href=../../../helmit/docs/testing/ title=Testing class=md-nav__link> Testing </a> </li> <li class=md-nav__item> <a href=../../../helmit/docs/benchmarking/ title=Benchmarking class=md-nav__link> Benchmarking </a> </li> <li class=md-nav__item> <a href=../../../helmit/docs/simulation/ title="Randomized Simulations" class=md-nav__link> Randomized Simulations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> Logging and Monitoring </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-8> Logging and Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1 type=checkbox id=nav-8-1> <label class=md-nav__link for=nav-8-1> Logging </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-1> Logging </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-lib-go/docs/logging/logging/ title="Overview of Logging" class=md-nav__link> Overview of Logging </a> </li> <li class=md-nav__item> <a href=../../../onos-lib-go/docs/logging/api/logging/ title="Logging API" class=md-nav__link> Logging API </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tlaplus-monitor/docs/ title="Conformance Monitoring with TLA+" class=md-nav__link> Conformance Monitoring with TLA+ </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#role-of-the-model-plugin title="Role of the Model Plugin" class=md-nav__link> Role of the Model Plugin </a> </li> <li class=md-nav__item> <a href=#onos-operator-deploy-time-compilation-of-model-plugins title="onos-operator deploy-time compilation of Model Plugins" class=md-nav__link> onos-operator deploy-time compilation of Model Plugins </a> </li> <li class=md-nav__item> <a href=#structure-of-a-model-plugin title="Structure of a Model Plugin" class=md-nav__link> Structure of a Model Plugin </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#modelplugin-interface title="ModelPlugin Interface" class=md-nav__link> ModelPlugin Interface </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-your-own-model-plugin title="Creating your own Model Plugin" class=md-nav__link> Creating your own Model Plugin </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#yang-files title="YANG files" class=md-nav__link> YANG files </a> </li> <li class=md-nav__item> <a href=#creating-templatesmodelyaml title="Creating templates/model.yaml" class=md-nav__link> Creating templates/model.yaml </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#verifying-compilation-and-installation-of-model-plugin title="Verifying compilation and installation of Model Plugin" class=md-nav__link> Verifying compilation and installation of Model Plugin </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#capabilities-on-gnmi-northbound-interface title="Capabilities on gNMI Northbound interface" class=md-nav__link> Capabilities on gNMI Northbound interface </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#openconfig-models title="OpenConfig Models" class=md-nav__link> OpenConfig Models </a> </li> <li class=md-nav__item> <a href=#readonly-paths-in-yang-models title="Readonly paths in YANG models" class=md-nav__link> Readonly paths in YANG models </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <!--
SPDX-FileCopyrightText: 2020-present Open Networking Foundation <info@opennetworking.org>

SPDX-License-Identifier: Apache-2.0
--> <h1 id=extending-onos-config-with-model-plugins>Extending onos-config with Model Plugins</h1> <p><code>onos-config</code> is an extensible configuration management system, that allows the configuration of many types and versions of devices to be managed concurrently.</p> <p>Information models in YANG format (RFC 6020) can be used to accurately define the configuration and state objects and attributes of a device. In practice a device's object model usually comprises a number of YANG files including augments and deviations, and must be considered as a combined unit.</p> <p>In <code>onos-config</code> a set of these combined YANG files defining a particular version of a device type is known as a <strong>Model</strong>.</p> <p>Over its lifecycle <code>onos-config</code> will have to deal with different models as its scope is expanded and as devices go through new release cycles. To allow this, models are loadable dynamically as plugins in the form of Linux or Mac shared object libraries <code>(\*.so)</code> using the YGOT library and are known as <strong>Model Plugins</strong>.</p> <p>The benefit of loading the Model Plugin as a shared library, is that it is run in the same process as <code>onos-config</code>, and accessing it is very fast, without involving a network hop.</p> <blockquote> <p>The model plugin must have been built with the same version of "go" and with the same version of dependencies to load correctly. </p> </blockquote> <p>The diagram shows the connection between the Model Plugin and the configuration store - linked by Device Type and Version. Effectively the primary key of the Model Registry is the Model Name and Version, whereas the primary key of the Configuration is the Device Name and Version.</p> <p><img alt="onos-config internals" src=https://docs.onosproject.org/onos-config/docs/images/onos-config-internals.png></p> <h2 id=role-of-the-model-plugin>Role of the Model Plugin</h2> <p>The Model Plugin enables the following functionality in <em>onos-config</em>:</p> <ol> <li>Ensures that invalid values are not saved in to the configuration (this covers wrong data type, data values beyond range or not matching a pattern, lists that are not within their cardinality limits)</li> <li>Ensuring that read only values are not allowed to be set (changed).</li> <li>Checking the validity of stores on startup</li> <li>Enabling the Operational State cache within onos-config </li> <li>Enabling the retrieval of attributes by type - CONFIG or OPERATIONAL</li> <li>Enabling clients to access the model metadata through the Admin NBI</li> <li>Enabling JSON Payloads in gNMI SetRequests to be interpreted</li> </ol> <h2 id=onos-operator-deploy-time-compilation-of-model-plugins>onos-operator deploy-time compilation of Model Plugins</h2> <p><code>onos-operator</code> is a Kubernetes controller that ensures Model Plugin YANG files are compiled in to shared object libraries that can be loaded by <code>onos-config</code>. This compilation is performed at "deploy time" to avoid any Go module incompatibilities.</p> <p>Two Kubernetes Custom Resource Definitions (CRDs) - <code>Model</code> and <code>ModelRegistry</code> are used to configure Model Plugins in the Kubernetes API. Instances of <code>Model</code> are loaded through Helm charts independent of <code>onos-config</code>. Different versions of a model can be loaded at the same time.</p> <p>When the <code>onos-config</code> Helm Chart is loaded, the <code>model-registry</code> sidecar runs alongside <code>onos-config</code> container, and ensures that any <code>Model</code> entries are compiled and loaded. The <code>model-registry</code> also keeps a cache of any compiled plugins.</p> <h2 id=structure-of-a-model-plugin>Structure of a Model Plugin</h2> <p>A Model Plugin is mainly generated by the <code>generator</code> command from the YGOT project, and a wrapper <code>modelmain.go</code> implementing the <code>ConfigModel</code> interface. They are compiled together with the <code>go build</code> command using the <code>-buildmode=plugin</code> option. </p> <p>Many examples of Model Plugins can be found in <a href=https://github.com/onosproject/onos-helm-charts/tree/master/config-models>config-models</a>.</p> <h3 id=modelplugin-interface>ModelPlugin Interface</h3> <p>The model plugin must implement the <code>ConfigModel</code> interface. This will allow it to be entered in to the Model Registry.</p> <div class=codehilite><pre><span></span><span class=kd>type</span> <span class=nx>ConfigModel</span> <span class=kd>interface</span> <span class=p>{</span>
    <span class=c1>// Info returns the config model info</span>
    <span class=nx>Info</span><span class=p>()</span> <span class=nx>ModelInfo</span>

    <span class=c1>// Data returns the config model data</span>
    <span class=nx>Data</span><span class=p>()</span> <span class=p>[]</span><span class=o>*</span><span class=nx>gnmi</span><span class=p>.</span><span class=nx>ModelData</span>

    <span class=c1>// Schema returns the config model schema</span>
    <span class=nx>Schema</span><span class=p>()</span> <span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=o>*</span><span class=nx>yang</span><span class=p>.</span><span class=nx>Entry</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span>

    <span class=c1>// GetStateMode returns the get state mode</span>
    <span class=nx>GetStateMode</span><span class=p>()</span> <span class=nx>GetStateMode</span>

    <span class=c1>// Unmarshaler returns the config model unmarshaler function</span>
    <span class=nx>Unmarshaler</span><span class=p>()</span> <span class=nx>Unmarshaler</span>

    <span class=c1>// Validator returns the config model validator function</span>
    <span class=nx>Validator</span><span class=p>()</span> <span class=nx>Validator</span>
<span class=p>}</span>
</pre></div> <h2 id=creating-your-own-model-plugin>Creating your own Model Plugin</h2> <h3 id=yang-files>YANG files</h3> <p>The YANG files to be used with <code>model-registry</code> should be collected together in a folder and named in the style:</p> <ul> <li><code>\&lt;modulename&gt;.yang</code> or </li> <li><code>\&lt;modulename&gt;@&lt;latestrevision&gt;.yang</code></li> </ul> <blockquote> <p><strong>Note</strong> The Yang files provided are required not to contain overlapping or clashing namespaces at the same path level. This requirement is necessary during the model compilation in YGOT because this tool offers no support for namespaces in the form of <code>/namespace:path/path2</code>, e.g. <code>/openconfig-system:system/clock</code>. YGOT compilation of a model containing <code>/openconfig-system:system/clock</code> will result in the path being <code>/system/clock</code></p> </blockquote> <p>To visualize and further validate the collection of YANG files, the <strong><a href=https://github.com/mbj4668/pyang>pyang</a></strong> tool can be used like:</p> <div class=codehilite><pre><span></span>&gt; pyang -f tree &lt;list of top level YANG files&gt;
</pre></div> <blockquote> <p>This writes a tree like format to standard out. It is recommeded to capture this in a file and persist it in the Helm chart with the extension .tree, for easy inspection </p> </blockquote> <h3 id=creating-templatesmodelyaml>Creating templates/model.yaml</h3> <p>To populate the <code>Model</code> CRD a <code>model.yaml</code> is necessary for each Model Plugin.</p> <p>It should contain a <code>modules</code> section that lists out only the <strong>top level</strong> YANG files</p> <blockquote> <p>YANG Files that are imported (e.g. with type definitions) do not need to be listed here </p> </blockquote> <p>An example of a <code>model.yaml</code> is <a href=https://github.com/onosproject/onos-helm-charts/blob/master/config-models/devicesim/templates/model.yaml>Devicesim 1.0.0 model</a></p> <h2 id=verifying-compilation-and-installation-of-model-plugin>Verifying compilation and installation of Model Plugin</h2> <p>Since the <code>Model</code> is a CRD, it can be managed through <code>kubectl</code></p> <div class=codehilite><pre><span></span>kubectl -n micro-onos get Models
NAME                                         AGE
onos-umbrella-1.0.0-config-model-devicesim   164m
onos-umbrella-1.0.0-config-model-stratum     164m
</pre></div> <p>Likewise with <code>ModelRegistry</code>:</p> <div class=codehilite><pre><span></span>kubectl -n micro-onos get ModelRegistry
NAME          AGE
onos-config   165m
</pre></div> <p>The <code>model-registry</code> can be seen in the <code>onos-config</code> Pod <em>description</em> with:</p> <div class=codehilite><pre><span></span>kubectl -n micro-onos describe <span class=k>$(</span>kubectl -n micro-onos get pods -l <span class=nv>type</span><span class=o>=</span>config -o name<span class=k>)</span>
</pre></div> <p>and its <em>logs</em> can be seen with:</p> <div class=codehilite><pre><span></span>kubectl -n micro-onos logs --follow <span class=k>$(</span>kubectl -n micro-onos get pods -l <span class=nv>type</span><span class=o>=</span>config -o name<span class=k>)</span> model-registry
</pre></div> <p>The <code>onos-cli</code> also has a command for accessing the <code>model-registry</code>:</p> <div class=codehilite><pre><span></span>$ onos modelregistry list
Devicesim: <span class=m>1</span>.0.0     <span class=m>4</span> YANGS
Name                      File                           Revision   Organization
openconfig-interfaces     openconfig-interfaces.yang     <span class=m>2017</span>-07-14   OpenConfig working group 
openconfig-openflow       openconfig-openflow.yang       <span class=m>2017</span>-06-01   OpenConfig working group 
openconfig-platform       openconfig-platform.yang       <span class=m>2016</span>-12-22   OpenConfig working group 
openconfig-system         openconfig-system.yang         <span class=m>2017</span>-07-06   OpenConfig working group 

Stratum: <span class=m>1</span>.0.0     <span class=m>21</span> YANGS
Name                      File                           Revision   Organization
iana-if-type              iana-if-type.yang              <span class=m>2017</span>-01-19                            
ietf-inet-types           ietf-inet-types.yang           <span class=m>2013</span>-07-15                            
ietf-interfaces           ietf-interfaces.yang           <span class=m>2014</span>-05-08-modified                          
ietf-yang-types           ietf-yang-types.yang           <span class=m>2013</span>-07-15                            
openconfig-interfaces     openconfig-interfaces.yang     <span class=m>2018</span>-11-21   OpenConfig working group 
openconfig-if-ip          openconfig-if-ip.yang          <span class=m>2018</span>-11-21   OpenConfig working group 
openconfig-lacp           openconfig-lacp.yang           <span class=m>2018</span>-11-21   OpenConfig working group 
openconfig-platform       openconfig-platform.yang       <span class=m>2019</span>-04-16   OpenConfig working group 
openconfig-platform-linecard openconfig-platform-linecard.yang <span class=m>2018</span>-11-21   OpenConfig working group 
openconfig-platform-port  openconfig-platform-port.yang  <span class=m>2018</span>-11-21   OpenConfig working group 
openconfig-platform-transceiver openconfig-platform-transceiver.yang <span class=m>2018</span>-11-25   OpenConfig working group 
openconfig-vlan           openconfig-vlan.yang           <span class=m>2018</span>-11-21   OpenConfig working group 
openconfig-system         openconfig-system.yang         <span class=m>2019</span>-01-29   OpenConfig working group 
openconfig-hercules-platform-linecard openconfig-hercules-platform-linecard.yang <span class=m>2018</span>-06-01   OpenConfig working group 
openconfig-hercules-qos   openconfig-hercules-qos.yang   <span class=m>2018</span>-06-01   OpenConfig working group 
openconfig-hercules-platform openconfig-hercules-platform.yang <span class=m>2018</span>-06-01   OpenConfig working group 
openconfig-hercules-platform-chassis openconfig-hercules-platform-chassis.yang <span class=m>2018</span>-06-01   OpenConfig working group 
openconfig-hercules-platform-port openconfig-hercules-platform-port.yang <span class=m>2018</span>-06-01   OpenConfig working group 
openconfig-hercules       openconfig-hercules.yang       <span class=m>2018</span>-06-01   OpenConfig working group 
openconfig-hercules-interfaces openconfig-hercules-interfaces.yang <span class=m>2018</span>-06-01   OpenConfig working group 
openconfig-hercules-platform-node openconfig-hercules-platform-node.yang <span class=m>2018</span>-06-01   OpenConfig working group 
</pre></div> <h3 id=capabilities-on-gnmi-northbound-interface>Capabilities on gNMI Northbound interface</h3> <p>The CapabilitiesResponse on the gNMI northound interface is generated dynamically from the combined <code>modules</code> of all the loaded Model Plugins.</p> <blockquote> <p>At runtime when devices are connected to <code>onos-config</code> the response to the Capabilities request are compared with the modules for their corresponding ModelPlugin - if there is not an exact match a warning is displayed.</p> </blockquote> <h2 id=openconfig-models>OpenConfig Models</h2> <p>Some devices that support OpenConfig Models report their capabilities using an OpenConfig versioning scheme e.g. 0.5.0, rather than the YANG revision date in the format 2017-07-06. If the device can correct its capabilities to give the revision then it should to be more consistent with non OpenConfig YANG models.</p> <p>Accessing OpenConfig model of a specific revision requires a number of steps in <a href=https://github.com/openconfig/public>Github</a>.</p> <p>For instance if a device reports it used openconfig-interfacess.yang <code>2.0.0</code>, then to get this file do:</p> <ul> <li>Browse to <a href=https://github.com/openconfig/public/blob/master/release/models/interfaces/openconfig-interfaces.yang>openconfig-interfaces.yang</a></li> <li>Observe in the list of <code>revision</code> items in the YANG file that the reference <code>2.0.0</code> corresponds to a release date of <code>2017-07-14</code></li> <li>Click in the <code>History</code> button</li> <li>In the <code>History</code> page for this file, see that the next commit after this date was on <code>Aug 9, 2017</code></li> <li>Click on the related <code>commit message</code></li> <li>In the list of files modified in that commit click the <code>...</code> next to the file <code>openconfig-interfacess.yang</code> and choose <code>View File</code></li> <li>In the page that displays the historical version of the file, click the <code>Raw</code> button</li> <li>In the resulting raw display of the YANG file verify that the latest revision is <code>2017-07-14</code></li> <li>Save the file locally as <code>openconfig-interfaces@2017-07-14.yang</code></li> </ul> <blockquote> <p>If the generator program reports that a dependency was required e.g. <code>openconfig-inet-types.yang</code> then the version of this file with a date equal to or before 2017-07-14 should be downloaded - it is <code>openconfig-inet-types@2017-07-14.yang</code></p> </blockquote> <h2 id=readonly-paths-in-yang-models>Readonly paths in YANG models</h2> <p>When an item (leaf, cntainer or list) in a YANG file has "config false" it is effectively a read-only attribute. Usually read-only items are interspersed throughout the YANG model.</p> <p>When the Model Plugin is loaded, <strong>setting</strong> of an attribute like <code>state/address</code> should give an appropriate error</p> <div class=codehilite><pre><span></span>&gt; gnmi_cli -address onos-config:5150 -set <span class=se>\</span>
    -proto <span class=s2>&quot;update: &lt;path: &lt;target: &#39;devicesim-1&#39;, elem: &lt;name: &#39;system&#39;&gt; elem: &lt;name: &#39;openflow&#39;&gt; elem: &lt;name: &#39;controllers&#39;&gt; elem: &lt;name: &#39;controller&#39; key: &lt;key: &#39;name&#39; value: &#39;main&#39;&gt;&gt; elem: &lt;name: &#39;connections&#39;&gt; elem: &lt;name: &#39;connection&#39; key: &lt;key: &#39;aux-id&#39; value: &#39;0&#39;&gt;&gt; elem: &lt;name: &#39;state&#39;&gt; elem: &lt;name: &#39;address&#39;&gt;&gt; val: &lt;string_val: &#39;192.0.2.11&#39;&gt;&gt;&quot;</span> <span class=se>\</span>
    -timeout 5s -en PROTO -alsologtostderr <span class=se>\</span>
    -client_crt /etc/ssl/certs/client1.crt -client_key /etc/ssl/certs/client1.key -ca_crt /etc/ssl/certs/onfca.crt
</pre></div> <p>gives the error:</p> <div class=codehilite><pre><span></span>rpc error: <span class=nv>code</span> <span class=o>=</span> InvalidArgument <span class=nv>desc</span> <span class=o>=</span> update contains a change to a <span class=nb>read</span> only
  path /system/openflow/controllers/controller<span class=o>[</span><span class=nv>name</span><span class=o>=</span>main<span class=o>]</span>/connections/connection<span class=o>[</span>aux-id<span class=o>=</span><span class=m>0</span><span class=o>]</span>/state/address. Rejected
</pre></div> </article> </div> </div> </main> <!-- Application footer --> <footer class=md-footer> <!-- Further information --> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <!-- Copyright and theme information --> <div class=md-footer-copyright> powered by <a href=https://www.mkdocs.org title=MkDocs>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ title="Material for MkDocs"> Material for MkDocs</a> </div> <!-- Social links --> <div class=md-footer-social> <link rel=stylesheet href=../../../assets/fonts/font-awesome.css> <a href=https://github.com/onosproject class="md-footer-social__link fa fa-"></a> <a href=https://onosproject.slack.com/ class="md-footer-social__link fa fa-"></a> <a href=https://www.youtube.com/channel/UCTQaOpqno48GTimdwyfytFw class="md-footer-social__link fa fa-"></a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.d9aa80ab.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script> <script src=../../../theme/js/onos-menu.js></script> </body> </html>