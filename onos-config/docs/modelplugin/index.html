<!--
Copyright 2019-present Open Networking Foundation
SPDX-FileCopyrightText: 2022 2020-present Open Networking Foundation <info@opennetworking.org>

SPDX-License-Identifier: Apache-2.0
--> <!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Open Network Operating System (ONOS)"><meta name=author content="Open Networking Foundation"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.0.2"><title>Modelplugin - onosproject</title><link rel=stylesheet href=../../../assets/stylesheets/application.982221ab.css><script src=../../../assets/javascripts/modernizr.1f0bcf2b.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css><link rel=stylesheet href=../../../styles/css/extra.css><link rel=stylesheet href=../../../theme/css/onos-menu.css></head> <body dir=ltr> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github> <path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z"/> </svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#extending-onos-config-with-configuration-model-plugins tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=../../.. title=onosproject class="md-header-nav__button md-logo"> <img src=../../../images/onos_logo_2017.png width=24 height=24> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> onosproject </span> <span class=md-header-nav__topic> Modelplugin </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/onosproject title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> onosproject </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=../../.. title=onosproject class="md-nav__button md-logo"> <img src=../../../images/onos_logo_2017.png width=48 height=48> </a> onosproject </label> <div class=md-nav__source> <a href=https://github.com/onosproject title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> onosproject </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. title=ONOS class=md-nav__link> ONOS </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Developers </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Developers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/community-info/ title="Contacts and Calendars" class=md-nav__link> Contacts and Calendars </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/prerequisites/ title="Development Prerequisites" class=md-nav__link> Development Prerequisites </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/dev_workflow/ title="Developer Workflow" class=md-nav__link> Developer Workflow </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/contributing/ title="Contribution Guidelines" class=md-nav__link> Contribution Guidelines </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/godocs/ title="GoDoc Pages" class=md-nav__link> GoDoc Pages </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/deploy_with_helm/ title="Deploy with Helm" class=md-nav__link> Deploy with Helm </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/deploy_onos_classic/ title="Deploy ONOS classic" class=md-nav__link> Deploy ONOS classic </a> </li> <li class=md-nav__item> <a href=../../../onos-docs/docs/content/developers/deploy_on_gcp/ title="Deploy with Helm on GCP" class=md-nav__link> Deploy with Helm on GCP </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Configuration Subsystem </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Configuration Subsystem </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ title="An Introduction to Configuration Susbsytem" class=md-nav__link> An Introduction to Configuration Susbsytem </a> </li> <li class=md-nav__item> <a href=../build/ title="How To Build Configuration Subsystem?" class=md-nav__link> How To Build Configuration Subsystem? </a> </li> <li class=md-nav__item> <a href=../run/ title="How To Run Configuration Subsystem?" class=md-nav__link> How To Run Configuration Subsystem? </a> </li> <li class=md-nav__item> <a href=../deployment/ title="How To Deploy with Helm" class=md-nav__link> How To Deploy with Helm </a> </li> <li class=md-nav__item> <a href=../cli/ title="Administrative CLI" class=md-nav__link> Administrative CLI </a> </li> <li class=md-nav__item> <a href=../../../onos-config-model/docs/modelplugin/ title="Configuration Model Plugins" class=md-nav__link> Configuration Model Plugins </a> </li> <li class=md-nav__item> <a href=../gnmi/ title="Northbound gNMI Service" class=md-nav__link> Northbound gNMI Service </a> </li> <li class=md-nav__item> <a href=../gnmi_extensions/ title="gNMI Extensions" class=md-nav__link> gNMI Extensions </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-9 type=checkbox id=nav-3-9> <label class=md-nav__link for=nav-3-9> APIs </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-3-9> APIs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/admin/ title="Admin API" class=md-nav__link> Admin API </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3-9-2 type=checkbox id=nav-3-9-2> <label class=md-nav__link for=nav-3-9-2> Types </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-3-9-2> Types </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/value/ title="Value Types" class=md-nav__link> Value Types </a> </li> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/configuration/ title="Configuration Types" class=md-nav__link> Configuration Types </a> </li> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/transaction/ title="Transaction Types" class=md-nav__link> Transaction Types </a> </li> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/proposal/ title="Proposal Types" class=md-nav__link> Proposal Types </a> </li> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/config/v2/extensions/ title="Extension Types" class=md-nav__link> Extension Types </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> Topology Subsystem </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> Topology Subsystem </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-topo/docs/cli/ title="How To Use Topology Subsystem CLI?" class=md-nav__link> How To Use Topology Subsystem CLI? </a> </li> <li class=md-nav__item> <a href=../../../onos-topo/docs/deployment/ title="How To Deploy with Helm" class=md-nav__link> How To Deploy with Helm </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4-3 type=checkbox id=nav-4-3> <label class=md-nav__link for=nav-4-3> APIs </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-4-3> APIs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-api/docs/onos/topo/topo/ title="Entity, Kind, Relationship API" class=md-nav__link> Entity, Kind, Relationship API </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Command Line Interface Subsystem (CLI) </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Command Line Interface Subsystem (CLI) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-cli/docs/setup/ title="How To Install and Run CLI Subsystem?" class=md-nav__link> How To Install and Run CLI Subsystem? </a> </li> <li class=md-nav__item> <a href=../../../onos-cli/docs/deployment/ title="How To Deploy with Helm" class=md-nav__link> How To Deploy with Helm </a> </li> <li class=md-nav__item> <a href=../../../onos-cli/docs/cli/onos/ title="ONOS CLI Commands" class=md-nav__link> ONOS CLI Commands </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> Graphical User Interface (GUI) </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-6> Graphical User Interface (GUI) </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-gui/docs/ title="ONOS-GUI Subsystem" class=md-nav__link> ONOS-GUI Subsystem </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/config-gui/ title="Configuration GUI" class=md-nav__link> Configuration GUI </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/ran-gui/ title="SD-RAN GUI" class=md-nav__link> SD-RAN GUI </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/architecture/ title="GUI Architecture" class=md-nav__link> GUI Architecture </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/prerequisites/ title="GUI Development Prerequisites" class=md-nav__link> GUI Development Prerequisites </a> </li> <li class=md-nav__item> <a href=../../../onos-gui/docs/deployment/ title="How to Deploy and Run with Helm?" class=md-nav__link> How to Deploy and Run with Helm? </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> Test Tools </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-7> Test Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../helmit/docs/cli/ title="Getting Started with Helmit" class=md-nav__link> Getting Started with Helmit </a> </li> <li class=md-nav__item> <a href=../../../helmit/docs/api/ title="Kubernetes and Helm APIs" class=md-nav__link> Kubernetes and Helm APIs </a> </li> <li class=md-nav__item> <a href=../../../helmit/docs/testing/ title=Testing class=md-nav__link> Testing </a> </li> <li class=md-nav__item> <a href=../../../helmit/docs/benchmarking/ title=Benchmarking class=md-nav__link> Benchmarking </a> </li> <li class=md-nav__item> <a href=../../../helmit/docs/simulation/ title="Randomized Simulations" class=md-nav__link> Randomized Simulations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> Logging and Monitoring </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-8> Logging and Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-8-1 type=checkbox id=nav-8-1> <label class=md-nav__link for=nav-8-1> Logging </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-8-1> Logging </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../onos-lib-go/docs/logging/logging/ title="Overview of Logging" class=md-nav__link> Overview of Logging </a> </li> <li class=md-nav__item> <a href=../../../onos-lib-go/docs/logging/api/logging/ title="Logging API" class=md-nav__link> Logging API </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../tlaplus-monitor/docs/ title="Conformance Monitoring with TLA+" class=md-nav__link> Conformance Monitoring with TLA+ </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#model-compiler title="Model Compiler" class=md-nav__link> Model Compiler </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-your-own-model-plugin title="Create your own Model Plugin" class=md-nav__link> Create your own Model Plugin </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#invoke-the-model-compiler title="Invoke the model compiler" class=md-nav__link> Invoke the model compiler </a> </li> <li class=md-nav__item> <a href=#loading-the-model-plugin title="Loading the Model Plugin" class=md-nav__link> Loading the Model Plugin </a> </li> <li class=md-nav__item> <a href=#model-plugins-and-gnmi-capabilities title="Model Plugins and gNMI Capabilities" class=md-nav__link> Model Plugins and gNMI Capabilities </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#capabilities-on-gnmi-northbound-interface title="Capabilities on gNMI Northbound interface" class=md-nav__link> Capabilities on gNMI Northbound interface </a> </li> <li class=md-nav__item> <a href=#capabilities-comparison-on-southbound-gnmi-interface title="Capabilities comparison on Southbound gNMI interface" class=md-nav__link> Capabilities comparison on Southbound gNMI interface </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#openconfig-models title="OpenConfig Models" class=md-nav__link> OpenConfig Models </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#readonly-paths-in-openconfig-models title="Readonly paths in OpenConfig models" class=md-nav__link> Readonly paths in OpenConfig models </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting title=Troubleshooting class=md-nav__link> Troubleshooting </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <!--
SPDX-FileCopyrightText: 2019-present Open Networking Foundation <info@opennetworking.org>

SPDX-License-Identifier: Apache-2.0
--> <h1 id=extending-onos-config-with-configuration-model-plugins>Extending onos-config with Configuration Model Plugins</h1> <p><code>onos-config</code> is an extensible configuration management system, that allows the configuration of many types and versions of targets (devices) to be managed concurrently.</p> <p>Information models in YANG format (RFC 6020) can be used to accurately define the configuration and state objects and attributes of a device. In practice a target's object model usually consists of a number of YANG files including augments and deviations, all of which must be considered as a combined unit.</p> <p>In <code>onos-config</code> a set of these combined YANG files defining a particular version of a target type is known as a <strong>model</strong>.</p> <p>Over its lifecycle onos-config will have to deal with different models as its scope is expanded and as devices - and configurable targets in general - go through their release cycles. To allow this, models are loadable as plugins in the form of sidecar containers and are accessible to <code>onos-config</code> via a gRPC interface that can be used to perform a number of model-specific tasks:</p> <ul> <li>Retrieve target capabilities (model schema in form of configuration paths)</li> <li>Validate target JSON configuration (for adherence to the schema and any consistency rules)</li> <li>Extract path/type/value list from target JSON configuration</li> </ul> <h2 id=model-compiler>Model Compiler</h2> <p>Plugins are built from a set of specified YANG files and a small <code>metadata.yaml</code> file, using facilities of a <code>onosproject/model-compiler</code> docker image. This docker image utilizes a number of off-the-shelf tools such as YGOT, pyang and automatically generates code and a Makefile that can be used to build, assemble and publish the model plugin docker image.</p> <h3 id=create-your-own-model-plugin>Create your own Model Plugin</h3> <p>To build your own configuration model plugin, assemble all the required YANG files and place them in the <code>yang/</code> directory located at the root of your project. Then, author a small YAML file <code>metadata.yaml</code> at the root of the project. This file names the model, specifies its version, names the Go package for the generated code and identifies the root YANG files that should be passed to YGOT by the model compiler. Here's an example:</p> <div class=codehilite><pre><span></span><span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">mymodel</span>
<span class=nt>version</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">1.0.0</span>
<span class=nt>artifactName</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">devicesim</span>
<span class=nt>goPackage</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">github.com/onosproject/config-models/models/mymodel</span>
<span class=nt>modules</span><span class=p>:</span>
  <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">openconfig-interfaces</span>
    <span class=nt>organization</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">OpenConfig working group</span>
    <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">2017-07-14</span>
    <span class=nt>file</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">openconfig-interfaces@2017-07-14.yang</span>
  <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">openconfig-openflow</span>
    <span class=nt>organization</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">OpenConfig working group</span>
    <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">2017-06-01</span>
    <span class=nt>file</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">openconfig-openflow@2017-06-01.yang</span>
  <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">openconfig-platform</span>
    <span class=nt>organization</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">OpenConfig working group</span>
    <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">2016-12-22</span>
    <span class=nt>file</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">openconfig-platform@2016-12-22.yang</span>
  <span class="p p-Indicator">-</span> <span class=nt>name</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">openconfig-system</span>
    <span class=nt>organization</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">OpenConfig working group</span>
    <span class=nt>revision</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">2017-07-06</span>
    <span class=nt>file</span><span class=p>:</span> <span class="l l-Scalar l-Scalar-Plain">openconfig-system@2017-07-06.yang</span>
</pre></div> <p>Note that the <code>yang/</code> directory will also need to contain all YANG files being included/referenced by any of the root modules.</p> <h2 id=invoke-the-model-compiler>Invoke the model compiler</h2> <p>Once the YANG files and metadata YAML file are ready invoke the model compiler as follows:</p> <div class=codehilite><pre><span></span>docker run -v <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>:/config-model onosproject/model-compiler:latest
</pre></div> <p>Afterwards, to compile and assemble the configuration model docker image, simply run:</p> <div class=codehilite><pre><span></span>make image
</pre></div> <h2 id=loading-the-model-plugin>Loading the Model Plugin</h2> <h2 id=model-plugins-and-gnmi-capabilities>Model Plugins and gNMI Capabilities</h2> <h3 id=capabilities-on-gnmi-northbound-interface>Capabilities on gNMI Northbound interface</h3> <p>The CapabilitiesResponse on the gNMI northound interface is generated dynamically from the <code>modeldata</code> section of all of the loaded Model Plugins.</p> <h3 id=capabilities-comparison-on-southbound-gnmi-interface>Capabilities comparison on Southbound gNMI interface</h3> <p>At runtime when devices are connected to onos-config the response to the Capabilities request are compared with the modeldata for their corresponding ModelPlugin - if there is not an exact match a warning is displayed.</p> <h2 id=openconfig-models>OpenConfig Models</h2> <p>Some devices that support OpenConfig Models report their capabilities using an OpenConfig versioning scheme e.g. 0.5.0, rather than the YANG revision date in the format 2017-07-06. If the device can correct its capabilities to give the revision then it should to be more consistent with non OpenConfig YANG models.</p> <p>Accessing OpenConfig model of a specific revision requires a number of steps in <a href=https://github.com/openconfig/public>Github</a>.</p> <p>For instance if a device reports it used openconfig-interfacess.yang <code>2.0.0</code>, then to get this file do:</p> <ul> <li>Browse to <a href=https://github.com/openconfig/public/blob/master/release/models/interfaces/openconfig-interfaces.yang>openconfig-interfaces.yang</a></li> <li>Observe in the list of <code>revision</code> items in the YANG file that the reference <code>2.0.0</code> corresponds to a release date of <code>2017-07-14</code></li> <li>Click in the <code>History</code> button</li> <li>In the <code>History</code> page for this file, see that the next commit after this date was on <code>Aug 9, 2017</code></li> <li>Click on the related <code>commit message</code></li> <li>In the list of files modified in that commit click the <code>...</code> next to the file <code>openconfig-interfacess.yang</code> and choose <code>View File</code></li> <li>In the page that displays the historical version of the file, click the <code>Raw</code> button</li> <li>In the resulting raw display of the YANG file verify that the latest revision is <code>2017-07-14</code></li> <li>Save the file locally as <code>openconfig-interfaces@2017-07-14.yang</code></li> </ul> <p>All the files in the <a href=../modelplugin/yang>yang</a> folder were downloaded in this way. They are not strictly needed once <code>generated.go</code> has been created, but are kept here for convenience, saving to have to run the procedure above if a change was needed.</p> <blockquote> <p>If the generator program reports that a dependency was required e.g. <code>openconfig-inet-types.yang</code> then the version of this file with a date equal to or before 2017-07-14 should be downloaded - it is <code>openconfig-inet-types@2017-07-14.yang</code></p> </blockquote> <h3 id=readonly-paths-in-openconfig-models>Readonly paths in OpenConfig models</h3> <p>When an item in an Openconfig YANG file has "config false" it is effectively a read-only attribute. Usually with OpenConfig read-only objects are interspersed throughout the YANG model.</p> <p>To see a list of Read Only paths use the command:</p> <div class=codehilite><pre><span></span>&gt; onos config get plugins -v
</pre></div> <p>When the Model Plugin is loaded, setting of an attribute like <code>state/address</code> should give an appropriate error</p> <div class=codehilite><pre><span></span>&gt; gnmi_cli -address onos-config:5150 -set <span class=se>\</span>
    -proto <span class=s2>&quot;update: &lt;path: &lt;target: &#39;devicesim-1&#39;, elem: &lt;name: &#39;system&#39;&gt; elem: &lt;name: &#39;openflow&#39;&gt; elem: &lt;name: &#39;controllers&#39;&gt; elem: &lt;name: &#39;controller&#39; key: &lt;key: &#39;name&#39; value: &#39;main&#39;&gt;&gt; elem: &lt;name: &#39;connections&#39;&gt; elem: &lt;name: &#39;connection&#39; key: &lt;key: &#39;aux-id&#39; value: &#39;0&#39;&gt;&gt; elem: &lt;name: &#39;state&#39;&gt; elem: &lt;name: &#39;address&#39;&gt;&gt; val: &lt;string_val: &#39;192.0.2.11&#39;&gt;&gt;&quot;</span> <span class=se>\</span>
    -timeout 5s -en PROTO -alsologtostderr <span class=se>\</span>
    -client_crt /etc/ssl/certs/client1.crt -client_key /etc/ssl/certs/client1.key -ca_crt /etc/ssl/certs/onfca.crt
</pre></div> <p>gives the error:</p> <div class=codehilite><pre><span></span>rpc error: <span class=nv>code</span> <span class=o>=</span> InvalidArgument <span class=nv>desc</span> <span class=o>=</span> update contains a change to a <span class=nb>read</span> only
  path /system/openflow/controllers/controller<span class=o>[</span><span class=nv>name</span><span class=o>=</span>main<span class=o>]</span>/connections/connection<span class=o>[</span>aux-id<span class=o>=</span><span class=m>0</span><span class=o>]</span>/state/address. Rejected
</pre></div> <h2 id=troubleshooting>Troubleshooting</h2> </article> </div> </div> </main> <!-- Application footer --> <footer class=md-footer> <!-- Further information --> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <!-- Copyright and theme information --> <div class=md-footer-copyright> powered by <a href=https://www.mkdocs.org title=MkDocs>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ title="Material for MkDocs"> Material for MkDocs</a> </div> <!-- Social links --> <div class=md-footer-social> <link rel=stylesheet href=../../../assets/fonts/font-awesome.css> <a href=https://github.com/onosproject class="md-footer-social__link fa fa-"></a> <a href=https://onosproject.slack.com/ class="md-footer-social__link fa fa-"></a> <a href=https://www.youtube.com/channel/UCTQaOpqno48GTimdwyfytFw class="md-footer-social__link fa fa-"></a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.d9aa80ab.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script> <script src=../../../theme/js/onos-menu.js></script> </body> </html>